# BERT_ContextClassifier
Given a document, perform classification into given categories.

## Environment
Without the admin permission to the machine of the LAB, I have to use anaconda to override the CUDA version for using up-to-date PyTorch packages.
Also, the pytorch version is for RTX3090, please check the GPU on your machine and navigate to 

```shell
### step-by-step

conda create -n BERT_ContextClassifier python=3.9
conda activate BERT_ContextClassifier

conda install pandas matplotlib scikit-learn

# Torch (1.13.1+cu116) for RTX 3090
conda install pytorch==1.13.1 torchvision==0.14.1 torchaudio==0.13.1 pytorch-cuda=11.6 -c pytorch -c nvidia
```

1. Dataset
1.1. Cancers
Cancers are known for their threat to personal health, sometimes proving fatal. Early
detection of any type of cancer can benefit the future prognosis. According to the 2018 statistics
from the World Health Organization (WHO), lung cancer had the highest prevalence globally,
with the highest mortality rate as well. Following lung cancer, breast cancer, and colorectal
cancer are also among the most notorious cancers of which people should be aware. We chose
the three cancers mentioned above as our models for training and provided ChatGPT with
information on symptoms that patients may notice at home and the risk factors associated with
these cancers. We specifically instructed ChatGPT to avoid using complicated medical terms,
aiming to mimic the tone of an actual patient. For example, in the case of lung cancer, the initial
prompt was as follows:
“Here are some general early symptoms and risk factors of lung cancer:
- Symptoms: (Provide symptoms)
- Risk factors: (Provide risk factors)
Please play the role of 20 patients who were eventually diagnosed with lung cancer and
describe your chief complaints to the doctor when you first entered the clinic, etc."
During the data-generating process, we identified additional diagnostic risk factors that
should be addressed in the clinic. For instance, we considered habits like smoking and
occasions for lung cancer, as well as whether the breast cancer patients had children or not.
Taking these factors into consideration, we modified our prompts by adding specific
requirements, such as
-"Modify the examples by including their pack years of smoking."
-"If there are occupationally related risk factors for lung cancer, please add some descriptions
about the job of the specific patients."
In the end, our dataset for cancers consisted of 302 descriptions for lung cancer, 305
descriptions for breast cancer, and 393 descriptions for colorectal cancer, respectively.

1.2. Heart diseases
The dataset of heart diseases consists of 2 parts: the first part includes about 700 data
based on medical records written in five medical papers about “acute decompensated heart
failure with hepatic congestion”, “Rheumatic heart disease, chest obstruction, heart, and kidney
deficiency”, “massive pericardial effusion caused by tuberculosis, infective endocarditis, mild
tricuspid regurgitation, and abscess at femur sinistra”, “Patent Ductus Arteriosus”,
“Endocarditis, neonatal systemic lupus erythematosus, complete AV block”, “Congenital heart
disease associated with a novel variant in the USP9X gene” and “Mechanical Aortic Valve
Thrombosis with Heart Failure” published in 2023, and generated by ChatGPT with prompt
“Assume you are the man/woman in the medical record "...", what will you tell your doctor?
Please give me 20 examples. You need to rearrange the sentences or use synonyms to rewrite
your expression so every example will not be similar to each other. you should express more
details, including symptoms, and how long the symptoms last. Start with “Hello/Hi doctor, …”
or “I feel…”.”.
In this part, ChatGPT generated the expressions of patients with not only heart disease but also
other complications.
The second part includes about 300 data, which are based on the common heart diseases
in Taiwan, such as arteriosclerosis, hypertension, myocardial infarction, arrhythmia, and heart
failure, and generated by ChatGPT with the prompt
“What will happen to a patient with ... disease?” followed by “Based on your answer, assume
that you are a patient with ... disease and you go see a doctor, what will you describe your
symptoms to your doctor? Give me 20 examples. You need to rearrange the sentences or use
synonyms to rewrite your expression so every example will not be similar to each other. you
should express more details, including symptoms, and how long the symptoms last. Start with
“Hello/Hi doctor, …” or “I feel…”.”.
In this part, ChatGPT generated the expressions of heart disease patients with fewer
complications.
To increase data variability, we use new prompts such as:
“Okay, now you can use more professional words, assuming that you are a patient with some
medical knowledge. Give me 20 more examples. Remember to rearrange the sentences to make
every expression different from each other.”, “Now change your expression more orally, like
a patient with little medical knowledge. Also, you should change your expression order to make
it not similar to your previous answer. Give me 20 examples.” or “Now, make a prediction
about your disease with “I guess it may be ... disease” or “Doctor, is this ... disease”, don't
make exactly the correct prediction. Also, the expression of symptoms and lasting time are still
needed. Give me 20 examples, do not only rewrite from your previous answers, or it may be
too similar. You need to change the order of your expression and use synonyms to further
rewrite the expressions.”
1.3. Kidney
The dataset of kidney diseases is composed of six subclasses and generated by ChatGPT
respectively. It includes acute kidney injury, chronic kidney disease, glomerulonephritis,
interstitial nephritis, kidney stones, and kidney cysts, as these are more common kidney
diseases in Taiwan. An example of a prompt:
“Please play the role of 5 Interstitial nephritis patients and describe their condition to the
doctor in English in the clinic. These patients do not know what disease they have. The
description includes symptoms, and how long these symptoms last. For variety, the number of
characters can be more or less, the content may not be complete. Don't exceed 500 characters
for each patient.”
Since symptoms and their duration are important parts of patients’ descriptions, we
especially ask ChatGPT to meet this requirement. The limitation of characters is due to the
constraint of input of our model. It can only input 512 tokens per data sample. In addition, one
prompt usually fails to generate data with high variety, even though we ask it to do so in the
prompt. Thus, for every 20 samples, we asked ChatGPT to generate data with more details or
more like spoken language or asked to idle chat, inform their age, guess their diseases, or guess
what leads to their symptoms. With this strategy, our dataset can meet a higher variety and be
close to real patients’ descriptions.
